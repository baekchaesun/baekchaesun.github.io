---
layout: post
date: 2023-05-04 20:03:08 +0900
title: "MATLAB을 이용한 푸리에 변환"
---

# MATLAB을 이용한 푸리에 변환
###### 정보통신공학과 202001638 백재선

---

### 1. 푸리에 변환이란 ?
### 2. 푸리에 급수, 오일러 공식, 적분, 직교성
### 3. MATLAB을 이용한 오디오 파일 FFT 간단 분석

---

### 1. 푸리에 변환이란?

*관점의 변환*

- 데이터를 시간 영역이 아닌 주파수 영역에서 보는 방법.
- 시간 영역에서는 주기성 데이터가 보이지 않는다.
- 주파수 영역에서는 주기성 데이터를 얻을 수 있다.
- 주기성 데이터나 주기성 함수를 찾는 데에 사용하는 도구이기 때문에 반복성이 없는 데이터는 유용한 정보를 얻을 수 없다.
  
<br>  
<br>   
<br>   
  <br> 
<br>   
  <br> 
<br>   
<br>   
  <br> 
<br>   
<br>   
<br>   
*성분의 분해*

- 시간 영역의 함수(주기함수)를 주파수 성분(삼각함수)으로 분해하는 변환.
- 여러 주파수 성분을 가지는 신호를 성분별로 함량을 표시하게 만듦.
- 주어진 함수를 주파수 성분들과 하나하나 내적(비교)하면서 닮음의 정도를 계산한다.
- 닮음의 정도는 내적한 함수의 적분값으로 알 수 있다.
- 닮음 정도가 높게 나오면 해당 주파수 성분이 들어있는 것이고, 낮게 나오면 없는 것이다.

*적용 분야*

- 불필요한 주파수 성분을 제거하는 데에 이용한다. (IFFT)
- 자동차 운전자의 안정성을 위해 주행 시 운전자에게 전달되는 진동을 분석한다.
- AI가 사람의 목소리를 구별한다.
- 노이즈 캔슬링에 이용한다.
- 뇌전도나 심전도 등의 생체 신호 분석에 이용한다.

---

### 2. 푸리에 급수, 오일러 공식, 직교성

1. *푸리에 급수*
<br> 
<br> 
<br>   
  <br> 
  <br> 
  <br> 
<br> 
<br> 
<br> 

- sin함수 부분만 따져보자.
<br>  
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
<br> 
- n 값이 증가할수록 그래프의 모양은 그 함수의 주기와 사이즈를 보기 쉽게 변한다. 
- 이를 이용하여 주파수 성분을 파악할 수 있다.

---

2. *오일러 공식*

  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
<br> 
- cos과 sin 두 삼각함수의 합을 지수함수로 간단하게 표현할 수 있다.
- 하나의 주기함수를 네 가지 방법으로 표현해보자.
<br> 
  <br> 
<br>   
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
<br> 
<br>   
<br>   
  <br> 
  <br> 
  <br> 
  <br> 
    #### 4번 방법
    - 오일러 함수는 복소수를 표현한 것이기 때문에 실질적 데이터를 이용하기 위해서는 실수 부분만을 가져와야한다.
    - 딱 보면 알겠지만 오일러 함수가 가장 심플하다.
    - 지수함수의 특성 상 미분하거나 적분해도 계산식이 크게 복잡해지지 않아 간편하다.
     
  <br> 
  <br> 
  <br> 
  <br> 
<br>   
<br>   
<br>    
    - sin, cos 두 요소로 표현되는 것을 오일러함수는 양과 위상으로 한번에 표현이 가능하다는 장점이 있다.
  <br>    
  <br> 
<br>   
<br>   
  <br> 
  <br> 
<br> 
<br>   
<br>    
<br>  
  
  <br> 
  <br> 
<br>   
<br>   
<br>   
<br> 
---

3. *직교성*

- 직교성 : 두 직선이 직각으로 만나는 경우 (내적의 값이 0인 경우) 직교한다고 말한다. 
- 이 경우 두 직선의 닮음 정도는 0이다. 
- 대표적으로 x벡터와 y벡터, sin함수와 cos함수가 서로 직교한다.
 
   #### sin함수와 cos함수를 내적해보자.
  - 함수의 내적 방법
 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
<br>   
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
    <br> 
  <br> 
<br>   
<br>   
 
  - 내적한 함수의 결과값이 두 함수의 닮음 정도를 나타낸다.
  - sin과 cos함수는 전혀 닮지 않은 함수이다. 
  - x벡터와 y벡터가 거의 모든 점을 표현할 수 있는 것처럼 sin함수와 cos함수는 거의 모든 주기성 함수를 표현할 수 있다.
  - 이는 위에서 푸리에 급수가 이미 말하고있는 것을 볼 수 있다.
   <br> 
<br>   
  <br> 
  <br> 
  <br> 
<br>   
 
---

### 3.MATLAB을 이용한 오디오파일 FFT 간단 분석

- MATLAB을 이용하여 2초짜리 .wav 파일 하나를 분석해보겠다.
- 다음은 fft분석에 필요한 함수들이다.
  1. plot (x,y)
     - x 벡터는 데이터 포인트의 x좌표
     - y 벡터는 데이터 포인트의 y좌표
  2. Y = fft(y) : fft알고리즘 사용.
  3. p = abs(Y) : 복소수의 절대값을 계산.
  4. [y,fs] = audioread('filename.wav') : MATLAB에서 제공하는 함수를 이용해 오디오 파일 포멧을 불러올 수 있다.
     - y는 wav파일에서 읽어온 신호를 나타내는 벡터
     - fs는 샘플링 주파수를 나타내는 스칼라 값
     - 자동으로 파일의 종류를 판별하여 데이터를 읽고 그 과정에서 발생 가능한 문제를 자동으로 처리해준다.
  
- mp3파일은 압축된 형태로 저장되어있는 오디오 파일이다. 전처리 과정을 통해야 실제 오디오 신호를 얻을 수 있는데,
- 이 과정에서 일부 데이터가 손실될 수 있어 분석 결과에 왜곡이 생길 수 있다.
- 반면 wav 파일은 압축되지 않은 상태로 저장되어있다. 전처리 과정이 필요없다.
- wav파일이 mp3파일보다 정보 손실이 적고 분석 결과가 정확하다.

  #### FFT 분석
  ```
  clc; clear;
  
  [y, fs] = audioread('kakao.wav');   % .wav 오디오파일 불러오기
  plot (y);                           % plot 함수로 불러운 데이타 시각화하기
  ```
  plot (y)
<br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
<br>   
<br>   
<br>   
  
  ```
  Y = fft (y);                        % fft 알고리즘 실행한 결과를 Y에 저장
  p = abs (Y);                        % Y에서 절대값 취한 결과를 p에 저장
  plot (p);
  ```
  plot (p)
<br> 
  <br> 
<br>   
  <br> 
<br>   
  <br> 
<br>   
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 

  ```
  n = length(p);
  p = p (1:n/2);                      % p의 데이터를 절반만 저장
  f = (1:n/2) / (n/fs);               % 교수님 사실 이건 잘 모르겠습니닷!!!!!!!! 
  p = p / (n/2);                      % 이것도요...

  plot (f, p);
  xlabel ('frequency (Hz)');
  ylabel ('manitude');
  ```
  plot (f, p)
<br> 
<br>   
<br>   
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
<br>   
<br>   
  <br> 
<br> 
    
  #### 분석 결과 
<br> 
<br>   
<br>   
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
<br>   
<br>   
<br> 
  <br> 
  <br> 
  <br> 
  <br> 
  <br> 
<br>   
  <br> 
  <br> 
<br>   
  <br> 
  <br> 
<br>   
  <br> 
  <br> 
<br>   
  <br> 
  <br> 
<br> 
크게 5개의 성분으로 나뉘는 걸 확인할 수 있다.